<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>SQL Tables | Microsoft Orleans Website </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="SQL Tables | Microsoft Orleans Website ">
    <meta name="generator" content="docfx 2.5.3.0">
    
    <link rel="shortcut icon" href="../../favicon.ico">
    <link rel="stylesheet" href="../../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../../styles/docfx.css">
    <link rel="stylesheet" href="../../styles/main.css">
    <meta property="docfx:navrel" content="../../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    <meta property="docfx:rel" content="../../">
  </head>
  <body data-spy="scroll" data-target="#affix">
    <div id="wrapper">
      <header>
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              <a class="navbar-brand" href="../../index.html">
                <img id="logo" class="svg" src="../../Images/logo-light.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>
        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items"></div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
              <h1 id="sql-system-storage" sourcefile="Documentation/Advanced-Concepts/Configuring-SQL-Tables.md" sourcestartlinenumber="6" sourceendlinenumber="6">SQL System Storage</h1>
              
<p sourcefile="Documentation/Advanced-Concepts/Configuring-SQL-Tables.md" sourcestartlinenumber="8" sourceendlinenumber="8">Any reliable production-style Orleans deployment requires using persistent storage to keep system state, specifically Orleans cluster status and the data used for the reminders functionality. In addition to out of the box support for Azure storage Orleans also provides an option to store this information in SQL server.</p>
<p sourcefile="Documentation/Advanced-Concepts/Configuring-SQL-Tables.md" sourcestartlinenumber="10" sourceendlinenumber="10">In order to use SQL server for the system store, one needs to adjust server-side and client-side configurations.</p>
<p sourcefile="Documentation/Advanced-Concepts/Configuring-SQL-Tables.md" sourcestartlinenumber="12" sourceendlinenumber="12">The server configuration should look like this:</p>
<pre sourcefile="Documentation/Advanced-Concepts/Configuring-SQL-Tables.md" sourcestartlinenumber="14" sourceendlinenumber="22"><code class="lang-xml">&lt;OrleansConfiguration xmlns=&quot;urn:orleans&quot;&gt;
  &lt;Globals&gt;
      &lt;SystemStore SystemStoreType =&quot;SqlServer&quot;
                 DeploymentId=&quot;OrleansTest&quot;
                 DataConnectionString=&quot;Data Source=(localdb)\MSSQLLocalDB;Initial Catalog=Orleans;Integrated Security=True;Pooling=False;Max Pool Size=200;Asynchronous Processing=True;MultipleActiveResultSets=True&quot; AdoInvariant=&quot;System.Data.SqlClient&quot; /&gt;
  &lt;/Globals&gt;
&lt;/OrleansConfiguration&gt;
</code></pre><p sourcefile="Documentation/Advanced-Concepts/Configuring-SQL-Tables.md" sourcestartlinenumber="24" sourceendlinenumber="24">The client configuration should look like this:</p>
<pre sourcefile="Documentation/Advanced-Concepts/Configuring-SQL-Tables.md" sourcestartlinenumber="26" sourceendlinenumber="32"><code class="lang-xml">&lt;ClientConfiguration xmlns=&quot;urn:orleans&quot;&gt;
      &lt;SystemStore SystemStoreType =&quot;SqlServer&quot;
                 DeploymentId=&quot;OrleansTest&quot;
                 DataConnectionString=&quot;Data Source=(localdb)\MSSQLLocalDB;Initial Catalog=Orleans;Integrated Security=True;Pooling=False;Max Pool Size=200;Asynchronous Processing=True;MultipleActiveResultSets=True&quot; AdoInvariant=&quot;System.Data.SqlClient&quot; /&gt;
&lt;/ClientConfiguration&gt;
</code></pre><p sourcefile="Documentation/Advanced-Concepts/Configuring-SQL-Tables.md" sourcestartlinenumber="34" sourceendlinenumber="34">Where the DataConnectionString is set to any valid SQL Server connection string. In order to use SQL Server as the store for system data, there’s now a script file <a href="https://github.com/dotnet/orleans/blob/master/src/OrleansSQLUtils/CreateOrleansTables_SqlServer.sql" sourcefile="Documentation/Advanced-Concepts/Configuring-SQL-Tables.md" sourcestartlinenumber="34" sourceendlinenumber="34">CreateOrleansTables_*</a>(where asterisk denotes database vendor) in the Binaries\OrleansServer folder which establishes the necessary database objects. Make sure that all servers that will be hosting Orleans silos can reach the database and has access rights to it! We’ve tripped up a few times on this seemingly trivial concern during our testing.</p>
<h3 id="sql-metrics-and-statistics-tables" sourcefile="Documentation/Advanced-Concepts/Configuring-SQL-Tables.md" sourcestartlinenumber="36" sourceendlinenumber="36">SQL Metrics and Statistics tables</h3>
<p sourcefile="Documentation/Advanced-Concepts/Configuring-SQL-Tables.md" sourcestartlinenumber="38" sourceendlinenumber="39">System tables can currently only be stored in Azure table or SQL server.
For Metrics and Statistics tables however, we provide a generic support to host it in any persistent storage. This is provided via the notion of a <code>StatisticsProvider</code>. Any application can write an arbitrary provider to store statistics and metrics data in a persistent store of their choice. Orleans provides an implemention of one such provider: SQL Table Statistics Provider.</p>
<p sourcefile="Documentation/Advanced-Concepts/Configuring-SQL-Tables.md" sourcestartlinenumber="41" sourceendlinenumber="41">In order to use SQL server for statistics and metrics tables, one needs to adjust server-side and client-side configurations.</p>
<p sourcefile="Documentation/Advanced-Concepts/Configuring-SQL-Tables.md" sourcestartlinenumber="43" sourceendlinenumber="43">The server configuration should look like this:</p>
<pre sourcefile="Documentation/Advanced-Concepts/Configuring-SQL-Tables.md" sourcestartlinenumber="45" sourceendlinenumber="56"><code class="lang-xml">&lt;OrleansConfiguration xmlns=&quot;urn:orleans&quot;&gt;
     &lt;Globals&gt;
         &lt;StatisticsProviders&gt;
             &lt;Provider Type=&quot;Orleans.Providers.SqlServer.SqlStatisticsPublisher&quot; Name=&quot;MySQLStatsProvider&quot; ConnectionString=&quot;Data Source=(localdb)\MSSQLLocalDB;Initial Catalog=Orleans;Integrated Security=True;Pooling=False;Max Pool Size=200;Asynchronous Processing=True;MultipleActiveResultSets=True&quot; /&gt;
         &lt;/StatisticsProviders&gt;
     &lt;/Globals&gt;
     &lt;Defaults&gt;
         &lt;Statistics ProviderType=&quot;MySQLStatsProvider&quot; WriteLogStatisticsToTable=&quot;true&quot;/&gt;
     &lt;/Defaults&gt;
&lt;/OrleansConfiguration&gt;
</code></pre><p sourcefile="Documentation/Advanced-Concepts/Configuring-SQL-Tables.md" sourcestartlinenumber="58" sourceendlinenumber="58">The client configuration should look like this:</p>
<pre sourcefile="Documentation/Advanced-Concepts/Configuring-SQL-Tables.md" sourcestartlinenumber="60" sourceendlinenumber="67"><code class="lang-xml">&lt;ClientConfiguration xmlns=&quot;urn:orleans&quot;&gt;
      &lt;StatisticsProviders&gt;
         &lt;Provider Type=&quot;Orleans.Providers.SqlServer.SqlStatisticsPublisher&quot; Name=&quot;SQL&quot; ConnectionString=&quot;Data Source=(localdb)\MSSQLLocalDB;Initial Catalog=Orleans;Integrated Security=True;Pooling=False;Max Pool Size=200;Asynchronous Processing=True;MultipleActiveResultSets=True&quot; /&gt;
      &lt;/StatisticsProviders&gt;
      &lt;Statistics ProviderType=&quot;MySQLStatsProvider&quot; WriteLogStatisticsToTable=&quot;true&quot;/&gt;
&lt;/ClientConfiguration&gt;
</code></pre>
            </article>
          </div>
          
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <div class="contribution">
                <ul class="nav">
                  <li>
                    <a href="https://github.com/dotnet/orleans/blob/gh-pages/src/Documentation/Advanced-Concepts/Configuring-SQL-Tables.md/#L1" class="contribution-link">Improve this Doc</a>
                  </li>
                </ul>
              </div>
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              <!-- <p><a class="back-to-top" href="#top">Back to top</a><p> -->
              </nav>
            </div>
          </div>
        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Copyright © 2015-2016 Microsoft<br>Generated by <strong>DocFX</strong></span>
          </div>
        </div>
      </footer>
    </div>
    
    <script type="text/javascript" src="../../styles/docfx.vendor.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script type="text/javascript" src="../../styles/docfx.js"></script>
    <script type="text/javascript" src="../../styles/main.js"></script>
  </body>
</html>
